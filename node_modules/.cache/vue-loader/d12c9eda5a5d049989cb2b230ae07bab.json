{"remainingRequest":"/Users/wangfeng/myproject/vueclitest/supermall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangfeng/myproject/vueclitest/supermall/src/views/home/home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangfeng/myproject/vueclitest/supermall/src/views/home/home.vue","mtime":1598423787590},{"path":"/Users/wangfeng/myproject/vueclitest/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangfeng/myproject/vueclitest/supermall/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangfeng/myproject/vueclitest/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangfeng/myproject/vueclitest/supermall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIb21lU3dpcGVyIGZyb20gJy4vY2hpbGRDb21wcy9ob21lU3dpcGVyJwppbXBvcnQgUmVjb21tZW5kVmlldyBmcm9tICcuL2NoaWxkQ29tcHMvUmVjb21tZW5kVmlldycKaW1wb3J0IEZlYXR1cmVWaWV3IGZyb20gJy4vY2hpbGRDb21wcy9GZWF0dXJlVmlldycKCmltcG9ydCBOYXZCYXIgZnJvbSAnY29tcG9uZW50cy9jb21tb24vbmF2YmFyL05hdkJhcicKaW1wb3J0IFRhYkNvbnRyb2wgZnJvbSAnY29tcG9uZW50cy9jb250ZW50L1RhYkNvbnRyb2wvVGFiQ29udHJvbCcKaW1wb3J0IEdvb2RzTGlzdCBmcm9tICdjb21wb25lbnRzL2NvbnRlbnQvZ29vZHMvR29vZHNMaXN0JwppbXBvcnQgU2Nyb2xsIGZyb20gJ2NvbXBvbmVudHMvY29tbW9uL3Njcm9sbC9TY3JvbGwudnVlJwppbXBvcnQgQmFja1RvcCBmcm9tICdjb21wb25lbnRzL2NvbnRlbnQvYmFja1RvcC9iYWNrVG9wJwoKaW1wb3J0IHsgZ2V0SG9tZU11bHRpZGF0YSxnZXRIb21lR29vZHMgfSBmcm9tICduZXR3b3JrL2hvbWUnCmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSAnY29tbW9uL3V0aWxzLmpzJwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTonaG9tZScsCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGJhbm5lcnM6W10sCiAgICAgICAgICAgIHJlY29tbWVuZHM6W10sCiAgICAgICAgICAgIGN1cnJlbnRUeXBlOidwb3AnLAogICAgICAgICAgICBpc1Nob3dCYWNrVG9wOmZhbHNlLAogICAgICAgICAgICB0YWJPZmZzZXRUb3A6MCwKICAgICAgICAgICAgaXNUYWJGaXhlZDpmYWxzZSwKICAgICAgICAgICAgc2F2ZVk6MCwKICAgICAgICAgICAgLy8gY3VycmVudEluZGV4OjAsCiAgICAgICAgICAgIGdvb2RzOnsKICAgICAgICAgICAgICAgICdwb3AnOntwYWdlOjAgLGxpc3Q6W119LAogICAgICAgICAgICAgICAgJ25ldyc6e3BhZ2U6MCAsbGlzdDpbXX0sCiAgICAgICAgICAgICAgICAnc2VsbCc6e3BhZ2U6MCAsbGlzdDpbXX0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBjb21wb25lbnRzOnsKICAgICAgICBIb21lU3dpcGVyLAogICAgICAgIFJlY29tbWVuZFZpZXcsCiAgICAgICAgRmVhdHVyZVZpZXcsCiAgICAgICAgTmF2QmFyLAogICAgICAgIFRhYkNvbnRyb2wsCiAgICAgICAgR29vZHNMaXN0LAogICAgICAgIFNjcm9sbCwKICAgICAgICBCYWNrVG9wCgogICAgfSwKICAgIGNvbXB1dGVkOnsKICAgICAgICBzaG93R29vZHMoKXsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ29vZHNbdGhpcy5jdXJyZW50VHlwZV0ubGlzdAogICAgICAgIH0KICAgIH0sCiAgICBkZXN0cm95ZWQoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ2hvbWUgZGVzdG9yeScpCiAgICB9LAogICAgYWN0aXZhdGVkKCkgewogICAgICAgIAogICAgICAgIHRoaXMuJHJlZnMuc2Nyb2xsLnNjcm9sbFRvKDAsdGhpcy5zYXZlWSwwKQogICAgICAgIHRoaXMuJHJlZnMuc2Nyb2xsLnJlZnJlc2goKQoKICAgICAgICAKICAgIH0sCiAgICBkZWFjdGl2YXRlZCgpIHsKICAgICAgICB0aGlzLnNhdmVZID0gdGhpcy4kcmVmcy5zY3JvbGwuZ2V0U2Nyb2xsWQogICAgICAgIAogICAgfSwKICAgIGNyZWF0ZWQoKXsKICAgICAgICAvLyAgMS7or7fmsYLlpJrkuKrmlbDmja4KICAgICAgICB0aGlzLmdldEhvbWVNdWx0aWRhdGEoKQogICAgICAgIC8vIGdldEhvbWVNdWx0aWRhdGEoKS50aGVuKHJlcyA9PnsKICAgICAgICAvLyAgICAgdGhpcy5iYW5uZXJzID0gcmVzLmRhdGEuYmFubmVyLmxpc3Q7CiAgICAgICAgLy8gICAgIHRoaXMucmVjb21tZW5kcyA9IHJlcy5kYXRhLnJlY29tbWVuZC5saXN0OwogICAgICAgICAgIAogICAgICAgIC8vIH0pCgogICAgICAgIC8vIDIu6K+35rGC5ZWG5ZOB5pWw5o2uCiAgICAgICAgdGhpcy5nZXRIb21lR29vZHMoJ3BvcCcpCiAgICAgICAgdGhpcy5nZXRIb21lR29vZHMoJ25ldycpCiAgICAgICAgdGhpcy5nZXRIb21lR29vZHMoJ3NlbGwnKQogICAgICAgIC8vIGdldEhvbWVHb29kcygncG9wJywxKS50aGVuKHJlcyA9PnsKICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJzMzMzMnLHJlcykKICAgICAgICAvLyB9KQoKICAgICAgICAvLyAzIOebkeWQrGl0ZW3kuK3lm77niYfliqDovb3lrozmiJAKICAgICAgICAvLyB0aGlzLiRidXMuJG9uKCdpdGVtSW1hZ2VMb2FkJywoKT0+ewogICAgICAgIC8vICAgICBjb25zb2xlLmxvZygnLS0tLS0tLScpOwogICAgICAgIC8vICAgICB0aGlzLiRyZWZzLnNjcm9sbC5yZWZyZXNoKCkKICAgICAgICAvLyB9KQogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgICAgIGNvbnN0IHJlZnJlc2ggPSBkZWJvdW5jZSh0aGlzLiRyZWZzLnNjcm9sbC5yZWZyZXNoKQoKICAgICAgICAgICAgdGhpcy4kYnVzLiRvbignaXRlbUltYWdlTG9hZCcsKCk9PnsKICAgICAgICAgICAgICAgIHJlZnJlc2goKQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJy0tLS0tLS0nKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIHRoaXMuJHJlZnMuc2Nyb2xsLnJlZnJlc2goKQogICAgICAgIH0pCgogICAgICAgIC8vICDojrflj5Z0YWJDb250cm9s55qEdGFiT2Zmc2V0VG9wCiAgICAgICAgLy8gIOaJgOaciee7hOS7tumDveacieS4gOS4quWxnuaApyAkZWwgCiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kcmVmcy50YWJDb250cm9sLiRlbC5vZmZzZXRUb3ApOwogICAgfSwKICAgIG1ldGhvZHM6ewogICAgICAgIC8vIC8vIOmYsuaKluWHveaVsAogICAgICAgIC8vIGRlYm91bmNlKGZ1bmMsZGFsYXkpewogICAgICAgIC8vICAgICBsZXQgdGltZXIgPSBudWxsCiAgICAKICAgICAgICAvLyAgICAgcmV0dXJuIGZ1bmN0aW9uKC4uLmFyZ3MpewogICAgICAgIC8vICAgICAgICAgaWYodGltZXIpIGNsZWFyVGltZW91dCh0aW1lcikKICAgICAgICAvLyAgICAgICAgIHRpbWVyID0gc2V0VGltZW91dCgoKSA9PnsKICAgICAgICAvLyAgICAgICAgICAgICBmdW5jLmFwcGx5KHRoaXMsYXJncykKICAgICAgICAvLyAgICAgICAgIH0sZGFsYXkpCiAgICAgICAgLy8gICAgIH0KCiAgICAgICAgLy8gfSwKICAgICAgICAvLyAg5LqL5Lu255uR5ZCs55u45YWz55qE5pa55rOVCiAgICAgICAgICB0YWJDbGljayhpbmRleCl7CiAgICAgICAgICAgICAgc3dpdGNoKGluZGV4KXsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFR5cGUgPSAncG9wJwogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VHlwZSA9ICduZXcnCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUeXBlID0nc2VsbCcKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnRhYkNvbnRyb2wxLmN1cnJlbnRJbmRleCA9IGluZGV4OwogICAgICAgICAgICAgICAgdGhpcy4kcmVmcy50YWJDb250cm9sMi5jdXJyZW50SW5kZXggPSBpbmRleDsKCiAgICAgICAgICB9LAogICAgICAgICAgY29udGVudFNjcm9sbChwb3NpdGlvbil7CiAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2cocG9zaXRpb24pCiAgICAgICAgICAgIC8vICAx44CBIOWIpOaWrWJhY2t0b3DmmK/lkKbmmL7npLoKICAgICAgICAgICAgICB0aGlzLmlzU2hvd0JhY2tUb3AgPSAoLSBwb3NpdGlvbi55KT4xMDAwCgogICAgICAgICAgICAvLyAgIDLjgIHlhrPlrpp0YWJjb250cm9s5piv5ZCm5ZC46aG277yIcG9zaXRpb27vvJpkaXhlZO+8iQogICAgICAgICAgICB0aGlzLmlzVGFiRml4ZWQgPSAoLXBvc2l0aW9uLnkpID50aGlzLnRhYk9mZnNldFRvcAoKICAgICAgICAgIH0sCgogICAgICAgICAgYmFja0NsaWNrKCl7CiAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2coJ+eCueWHuycpCiAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2codGhpcy4kcmVmcy5zY3JvbGwuc2Nyb2xsKQoKICAgICAgICAgICAgLy8gICB0aGlzLiRyZWZzLnNjcm9sbC5zY3JvbGwuc2Nyb2xsVG8oMCwwLDUwMCkKICAgICAgICAgICAgdGhpcy4kcmVmcy5zY3JvbGwuc2Nyb2xsVG8oMCwwKQogICAgICAgICAgfSwKICAgICAgICAgIGxvYWRNb3JlKCl7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+S4iuaLieWKoOi9veabtOWkmicpCiAgICAgICAgICAgICAgdGhpcy5nZXRIb21lR29vZHModGhpcy5jdXJyZW50VHlwZSkKICAgICAgICAgICAgICB0aGlzLiRyZWZzLnNjcm9sbC5maW5pc2hQdWxsVXAoKQogICAgICAgICAgfSwKCiAgICAgICAgICBzd2lwZXJJbWFnZUxvYWQoKXsKICAgICAgICAgICAgICAgdGhpcy50YWJPZmZzZXRUb3AgPSB0aGlzLiRyZWZzLnRhYkNvbnRyb2wyLiRlbC5vZmZzZXRUb3A7CgogICAgICAgICAgfSwKCgogICAgICAgIC8vICDnvZHnu5zor7fmsYLnm7jlhbPmlrnms5UKICAgICAgICBnZXRIb21lTXVsdGlkYXRhKCl7CiAgICAgICAgICAgIGdldEhvbWVNdWx0aWRhdGEoKS50aGVuKHJlcyA9PnsKICAgICAgICAgICAgdGhpcy5iYW5uZXJzID0gcmVzLmRhdGEuYmFubmVyLmxpc3Q7CiAgICAgICAgICAgIHRoaXMucmVjb21tZW5kcyA9IHJlcy5kYXRhLnJlY29tbWVuZC5saXN0OwogICAgICAgICAgIAogICAgICAgIH0pCgogICAgICAgIH0sCiAgICAgICAgZ2V0SG9tZUdvb2RzKHR5cGUpewogICAgICAgICAgICBjb25zdCBwYWdlID0gdGhpcy5nb29kc1t0eXBlXS5wYWdlKzEKICAgICAgICAgICAgZ2V0SG9tZUdvb2RzKHR5cGUscGFnZSkudGhlbihyZXMgPT57CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCczMzMzJyxyZXMpCiAgICAgICAgICAgIHRoaXMuZ29vZHNbdHlwZV0ubGlzdC5wdXNoKC4uLnJlcy5kYXRhLmxpc3QpIAogICAgICAgICAgICB0aGlzLmdvb2RzW3R5cGVdLnBhZ2UgKz0gMQogICAgICAgIH0pCiAgICAgICAgfSwKCiAgICAgIAogICAgICAgCgogICAgfQp9Cg=="},{"version":3,"sources":["home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA","file":"home.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\n    <div id=\"home\" class=\"wapper\">\n        <nav-bar class=\"home-nav\">\n            <div slot=\"center\">\n                购物街\n            </div>\n        </nav-bar>\n\n        <tab-control \n            class=\"tab-control\" \n            :titles=\"['流行','新款','精选']\" \n            @tabClick='tabClick'\n            ref=\"tabControl1\"\n            v-show=\"isTabFixed\"\n            ></tab-control>\n       \n        <scroll \n            class=\"content\" \n            ref=\"scroll\" \n            :probe-type=\"3\"\n            @scroll='contentScroll'\n            :pull-up-load='true'\n            @pullingUp='loadMore'>\n             <home-swiper :banners='banners' @swiperImageLoad='swiperImageLoad'></home-swiper>\n            <recommend-view :recommends='recommends'></recommend-view>\n            <feature-view></feature-view>\n            <tab-control class=\"tab-control\" \n            :titles=\"['流行','新款','精选']\" \n            @tabClick='tabClick'\n            ref=\"tabControl2\"\n            :class=\"{fixed:isTabFixed}\"></tab-control>\n            <goods-list :goods = showGoods></goods-list>\n        </scroll>\n        <back-top @click.native=\"backClick\" v-show=\"isShowBackTop\"/>\n      \n      \n    </div>\n</template>\n\n<script>\nimport HomeSwiper from './childComps/homeSwiper'\nimport RecommendView from './childComps/RecommendView'\nimport FeatureView from './childComps/FeatureView'\n\nimport NavBar from 'components/common/navbar/NavBar'\nimport TabControl from 'components/content/TabControl/TabControl'\nimport GoodsList from 'components/content/goods/GoodsList'\nimport Scroll from 'components/common/scroll/Scroll.vue'\nimport BackTop from 'components/content/backTop/backTop'\n\nimport { getHomeMultidata,getHomeGoods } from 'network/home'\nimport { debounce } from 'common/utils.js'\n\nexport default {\n    name:'home',\n    data() {\n        return {\n            banners:[],\n            recommends:[],\n            currentType:'pop',\n            isShowBackTop:false,\n            tabOffsetTop:0,\n            isTabFixed:false,\n            saveY:0,\n            // currentIndex:0,\n            goods:{\n                'pop':{page:0 ,list:[]},\n                'new':{page:0 ,list:[]},\n                'sell':{page:0 ,list:[]}\n            }\n        }\n    },\n    components:{\n        HomeSwiper,\n        RecommendView,\n        FeatureView,\n        NavBar,\n        TabControl,\n        GoodsList,\n        Scroll,\n        BackTop\n\n    },\n    computed:{\n        showGoods(){\n            return this.goods[this.currentType].list\n        }\n    },\n    destroyed() {\n        console.log('home destory')\n    },\n    activated() {\n        \n        this.$refs.scroll.scrollTo(0,this.saveY,0)\n        this.$refs.scroll.refresh()\n\n        \n    },\n    deactivated() {\n        this.saveY = this.$refs.scroll.getScrollY\n        \n    },\n    created(){\n        //  1.请求多个数据\n        this.getHomeMultidata()\n        // getHomeMultidata().then(res =>{\n        //     this.banners = res.data.banner.list;\n        //     this.recommends = res.data.recommend.list;\n           \n        // })\n\n        // 2.请求商品数据\n        this.getHomeGoods('pop')\n        this.getHomeGoods('new')\n        this.getHomeGoods('sell')\n        // getHomeGoods('pop',1).then(res =>{\n        //     console.log('3333',res)\n        // })\n\n        // 3 监听item中图片加载完成\n        // this.$bus.$on('itemImageLoad',()=>{\n        //     console.log('-------');\n        //     this.$refs.scroll.refresh()\n        // })\n    },\n    mounted() {\n            const refresh = debounce(this.$refs.scroll.refresh)\n\n            this.$bus.$on('itemImageLoad',()=>{\n                refresh()\n                // console.log('-------');\n            \n            // this.$refs.scroll.refresh()\n        })\n\n        //  获取tabControl的tabOffsetTop\n        //  所有组件都有一个属性 $el \n        // console.log(this.$refs.tabControl.$el.offsetTop);\n    },\n    methods:{\n        // // 防抖函数\n        // debounce(func,dalay){\n        //     let timer = null\n    \n        //     return function(...args){\n        //         if(timer) clearTimeout(timer)\n        //         timer = setTimeout(() =>{\n        //             func.apply(this,args)\n        //         },dalay)\n        //     }\n\n        // },\n        //  事件监听相关的方法\n          tabClick(index){\n              switch(index){\n                    case 0:\n                        this.currentType = 'pop'\n                        break\n                    case 1:\n                        this.currentType = 'new'\n                        break\n                    case 2:\n                        this.currentType ='sell'\n                        break\n              }\n                this.$refs.tabControl1.currentIndex = index;\n                this.$refs.tabControl2.currentIndex = index;\n\n          },\n          contentScroll(position){\n            //   console.log(position)\n            //  1、 判断backtop是否显示\n              this.isShowBackTop = (- position.y)>1000\n\n            //   2、决定tabcontrol是否吸顶（position：dixed）\n            this.isTabFixed = (-position.y) >this.tabOffsetTop\n\n          },\n\n          backClick(){\n            //   console.log('点击')\n            //   console.log(this.$refs.scroll.scroll)\n\n            //   this.$refs.scroll.scroll.scrollTo(0,0,500)\n            this.$refs.scroll.scrollTo(0,0)\n          },\n          loadMore(){\n              console.log('上拉加载更多')\n              this.getHomeGoods(this.currentType)\n              this.$refs.scroll.finishPullUp()\n          },\n\n          swiperImageLoad(){\n               this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;\n\n          },\n\n\n        //  网络请求相关方法\n        getHomeMultidata(){\n            getHomeMultidata().then(res =>{\n            this.banners = res.data.banner.list;\n            this.recommends = res.data.recommend.list;\n           \n        })\n\n        },\n        getHomeGoods(type){\n            const page = this.goods[type].page+1\n            getHomeGoods(type,page).then(res =>{\n            console.log('3333',res)\n            this.goods[type].list.push(...res.data.list) \n            this.goods[type].page += 1\n        })\n        },\n\n      \n       \n\n    }\n}\n</script>\n\n<style scoped>\n#home{\n    /* padding-top:44px; */\n    height: 100vh;\n    position: relative;\n}\n.home-nav{\n    background-color: var(--color-tint);\n    color: #fff;\n\n    /* position: fixed;\n    left: 0;\n    right: 0;\n    top: 0;\n    z-index: 9; */\n}\n/* .fixed{\n    position: fixed;\n    left: 0;\n    right: 0;\n    top:44px;\n} */\n/* .tab-control{\n    position: sticky;\n    top: 44px;\n    z-index: 9;\n\n} */\n.tab-control{\n    position: relative;\n    z-index: 9;\n}\n.content{\n  \n    overflow: hidden;\n    position:absolute;\n    top:44px;\n    bottom: 49px;\n    right: 0;\n    left: 0;\n}\n\n/* .content{\n    height: calc(100vh - 93px);\n    overflow: hidden;\n    margin-top: 48px;\n} */\n</style>"]}]}